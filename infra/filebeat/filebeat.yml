filebeat.inputs:
- type: log
  enabled: true
  paths:
    # The /log-data volume points to /cowrie/var inside the Cowrie container
    - /log-data/log/cowrie/cowrie.json
  json.keys_under_root: true
  json.add_error_key: true

processors:
  - geoip:
      field: src_ip
      target_field: geoip
      ignore_missing: true

output.elasticsearch:
  hosts: ["elasticsearch:9200"]
  pipeline: geoip
